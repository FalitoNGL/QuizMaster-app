{
    "build": [
        "Procfile"
    ],
    "deploy": {
        "startCommand": "php artisan migrate --force && php artisan serve --host=0.0.0.0 --port=$PORT"
    },
    "providers": [
        "php",
        "nodejs"
    ],
    "phases": {
        "setup": {
            "aptPkgs": [
                "libpng-dev",
                "libjpeg-dev",
                "libfreetype6-dev"
            ]
        },
        "install": {
            "dependsOn": [
                "setup"
            ],
            "cmds": [
                "install-php-extensions gd",
                "composer install --no-dev --optimize-autoloader",
                "npm ci",
                "npm run build"
            ]
        }
    }
}